# Logs Directory

This directory contains runtime logs generated by the Thoth sync system. Log files are excluded from version control but this README is included to document the expected log types.

## Log Files

### sync.log

**Purpose:** Main synchronization log capturing the overall sync process.

**Contents:**
- Browser session initialization
- Login state detection and waiting
- Channel discovery results
- Sync cycle completion notifications
- High-level error messages

**Example entries:**
```
[2026-01-07 20:14:06,150] INFO Discord discovery: 101 server IDs from sidebar
[2026-01-07 20:14:09,477] INFO Discord discovery: 17 channel links found for guild @me
[2026-01-07 20:23:07,287] INFO Sync success discord:Text #general mode=recent inserted=50 edited=0
[2026-01-07 20:24:26,106] ERROR Future exception was never retrieved
```

**Log levels:**
- `INFO` - Normal operations and progress updates
- `WARNING` - Non-critical issues (login pending, no messages found, etc.)
- `ERROR` - Exceptions and critical failures

---

### tasks.log

**Purpose:** Detailed task-level execution log for the sync queue.

**Contents:**
- Task queue additions with reasons
- Task execution start/stop
- Task results (success, failure, pending)
- Task transitions and scheduling

**Example entries:**
```
[2026-01-07 20:18:19,375] INFO Task queued name=sync_channel label=discord:#general reason=read recent activity
[2026-01-07 20:18:19,376] INFO Task status current=sync_channel:discord:#general next=sync_channel:discord:#random
[2026-01-07 20:18:19,376] INFO Task start name=sync_channel label=discord:#general
[2026-01-07 20:18:22,123] INFO Task result name=sync_channel label=discord:#general status=ok details=mode=recent recent_inserted=50
```

**Task types:**
- `check_notifications` - Periodic check for unread activity
- `check_servers` - Verify source is responsive
- `discover_channels` - Auto-discover channels (Discord)
- `sync_channel` - Sync messages from a specific channel
- `login_pending` - Waiting for user authentication

---

### playwright.browsers

**Purpose:** Playwright browser cache/state (not a log file, but stored here).

**Note:** This is a directory created by Playwright for browser binaries and cache. It should be excluded from git.

---

## Log Rotation

Logs are not automatically rotated. For long-running instances, consider:

1. **Manual rotation:**
   ```bash
   mv logs/sync.log logs/sync.log.1
   mv logs/tasks.log logs/tasks.log.1
   ```

2. **External rotation (logrotate):**
   ```
   /path/to/thoth/logs/*.log {
       daily
       rotate 7
       compress
       missingok
       notifempty
   }
   ```

---

## Debugging Tips

### Find errors
```bash
grep -i error logs/sync.log
grep -i error logs/tasks.log
```

### Watch live sync progress
```bash
tail -f logs/sync.log
```

### Count successful syncs
```bash
grep -c "Sync success" logs/sync.log
```

### Find specific channel
```bash
grep "general-chat" logs/tasks.log
```
