# Data Directory

This directory contains runtime data generated by Thoth. All files in this directory are excluded from version control.

## Contents

### thoth.db

The main SQLite database storing all scraped messages.

**Tables:**
- `sources` - Chat platforms (Discord, Slack, Telegram)
- `channels` - Individual channels/conversations
- `users` - Message authors
- `messages` - Scraped message content
- `reactions` - Emoji reactions on messages
- `sync_state` - Synchronization progress per channel
- `events` - Audit log of significant events

**Quick queries:**
```bash
# Count total messages
sqlite3 data/thoth.db "SELECT COUNT(*) FROM messages;"

# List channels with message counts
sqlite3 data/thoth.db "SELECT c.name, COUNT(m.id) FROM channels c LEFT JOIN messages m ON c.id = m.channel_id GROUP BY c.id ORDER BY COUNT(m.id) DESC LIMIT 20;"

# Recent messages with authors
sqlite3 data/thoth.db "SELECT u.display_name, m.content FROM messages m JOIN users u ON m.author_id = u.id ORDER BY m.created_at DESC LIMIT 10;"
```

### thoth.db-wal, thoth.db-shm

SQLite Write-Ahead Log files. These are temporary and managed by SQLite.

**Note:** Do not delete these while the sync is running. They contain uncommitted transactions.

### profiles/

Browser profile data used by Playwright. Contains:
- Cookies and session data
- Login state for each platform
- Browser cache

**Important:** This directory stores your authentication state. If you delete it, you'll need to log in again to all platforms.

---

## Backup & Restore

### Creating a backup
```bash
# Stop the sync first
sqlite3 data/thoth.db ".backup data/thoth-backup.db"
```

### Restoring from backup
```bash
cp data/thoth-backup.db data/thoth.db
```

---

## Database Size

The database grows with message count. Approximate sizes:
- 1,000 messages: ~1 MB
- 10,000 messages: ~5-10 MB
- 100,000 messages: ~50-100 MB

To check current size:
```bash
ls -lh data/thoth.db
```

---

## Resetting

To start fresh:
```bash
rm -rf data/thoth.db data/thoth.db-*
rm -rf data/profiles/
```

You'll need to log in again after deleting profiles.
